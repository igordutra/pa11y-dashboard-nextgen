services:
  # Backend API (Web Service)
  - type: web
    name: pa11y-dashboard-api
    env: docker
    region: oregon # or your preferred region
    plan: free
    rootDir: server
    healthCheckPath: /
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3000
      - key: MONGO_URI
        sync: false # Set this in Render Dashboard (Atlas URI)
      - key: CLIENT_URL
        sync: false # Set this to your frontend URL
      - key: PUPPETEER_EXECUTABLE_PATH
        value: /usr/bin/chromium

  # Frontend (Static Site)
  - type: web
    name: pa11y-dashboard-web
    env: static
    region: oregon
    plan: free
    rootDir: client
    buildCommand: npm install && npm run build
    publishDir: dist
    envVars:
      - key: VITE_API_URL
        sync: false # Set this to your pa11y-dashboard-api URL
    routes:
      - type: rewrite
        source: /*
        destination: /index.html
